name: Deployment (test)

on:
  workflow_dispatch:

jobs:

  build:
    name: Test Build
    uses: ./.github/workflows/build.yaml
    with:
      DEPLOYMENT_ENVIRONMENT: test
      FRONTEND_IMAGE_NAME: playmint/ds-shell
      CONTRACTS_IMAGE_NAME: playmint/ds-contracts
      SERVICES_IMAGE_NAME: playmint/ds-services
      PLATFORMS: linux/amd64
      AZURE_FRONT_DOOR_PURGE: true
      AZURE_FRONT_DOOR_PROFILE: downstream-test
      AZURE_FRONT_DOOR_DOMAIN: testnet.downstream.game
      AZURE_FRONT_DOOR_ENDPOINT: frontend-ds-test
    secrets:
      AZURE_REGISTRY_URL: ${{ secrets.AZURE_REGISTRY_URL }}
      AZURE_REGISTRY_USERNAME: ${{ secrets.AZURE_REGISTRY_USERNAME }}
      AZURE_REGISTRY_PASSWORD: ${{ secrets.AZURE_REGISTRY_PASSWORD }}
      AZURE_CREDENTIALS: ${{ secrets.AZURE_CREDENTIALS }}
      AZURE_CLUSTER_NAME: ${{ secrets.AZURE_CLUSTER_NAME }}
      AZURE_CLUSTER_RESOURCE_GROUP: ${{ secrets.AZURE_CLUSTER_RESOURCE_GROUP }}
      UNITY_SERIAL: ${{ secrets.UNITY_SERIAL }}
      UNITY_EMAIL: ${{ secrets.UNITY_EMAIL }}
      UNITY_PASSWORD: ${{ secrets.UNITY_PASSWORD }}
